{"version":3,"file":"ngx-editor-plugins.umd.js","sources":["../../../src/plugins/placeholder.ts","../../../src/plugins/editable.ts","../../../src/plugins/image.ts","../../../src/plugins/ngx-editor-plugins.ts"],"names":["Plugin","PluginKey","DecorationSet","Decoration","NodeSelection"],"mappings":";;;;;;IAGA,IAAM,mBAAmB,GAAG,cAAc,CAAC;AAC3C,IAAA,IAAM,qBAAqB,GAAG,wBAAwB,CAAC;AACvD,QACM,iBAAiB,GAAG,UAAC,IAAkC;AAAI,QAAtC,qBAAA,EAAA,0BAAkC;AAAI,QAC/D,OAAO,IAAIA,uBAAM,CAAC;AACpB,YAAI,GAAG,EAAE,IAAIC,0BAAS,CAAC,aAAa,CAAC;AACrC,YAAI,KAAK,EAAE;AACX,gBAAM,IAAI;AACP,oBAAK,OAAO,IAAI,CAAC;AACpB,iBAAO;AACP,gBAAM,KAAK,YAAC,EAAe,EAAE,WAAmB;AAAI;AAChC,oBAAZ,IAAM,WAAW,SAAG,EAAE,CAAC,OAAO,CAAC,oBAAoB,CAAC,mCAAI,WAAW,CAAC;AAC5E,oBAAQ,OAAO,WAAW,CAAC;AAC3B,iBAAO;AACP,aAAK;AACL,YAAI,KAAK,EAAE;AACX,gBAAM,WAAW,YAAC,KAAkB;AAAI;AAC3B,oBAAL,IAAM,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC;AAC9B,oBACQ,IAAM,WAAW,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AACjD,oBACQ,IAAI,CAAC,WAAW,EAAE;AAC1B,wBAAU,OAAOC,6BAAa,CAAC,KAAK,CAAC;AACrC,qBAAS;AACT,oBACQ,IAAI,GAAG,CAAC,UAAU,KAAK,CAAC,WAAI,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,UAAU,0CAAE,WAAW,CAAA,IAAI,GAAG,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,EAAE;AACvG,wBAAU,IAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAC/D,wBAAU,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;AAC7D,wBAAU,aAAa,CAAC,WAAW,GAAG,WAAW,CAAC;AAClD,wBAAU,OAAOA,6BAAa,CAAC,MAAM,CAAC,GAAG,EAAE,CAACC,0BAAU,CAAC,MAAM,CAAC,CAAC,EAAE,aAAa,CAAC,CAAC,CAAC,CAAC;AAClF,qBAAS;AACT,oBACQ,OAAOD,6BAAa,CAAC,KAAK,CAAC;AACnC,iBAAO;AACP,aAAK;AACL,SAAG,CAAC,CAAC;AACL,IAAA,EAAE;AACF;AAC+B;AAAC,QCvC1B,cAAc,GAAG,UAAC,QAAe;AAAI,QAAnB,yBAAA,EAAA,eAAe;AAAI,QACzC,OAAO,IAAIF,uBAAM,CAAC;AACpB,YAAI,GAAG,EAAE,IAAIC,0BAAS,CAAC,UAAU,CAAC;AAClC,YAAI,KAAK,EAAE;AACX,gBAAM,IAAI;AACR,oBAAM,OAAO,QAAQ,CAAC;AACxB,iBAAO;AACP,gBAAM,KAAK,YAAC,EAAe,EAAE,WAAoB;AAAI;AACjC,oBAAZ,aAAO,EAAE,CAAC,OAAO,CAAC,iBAAiB,CAAC,mCAAI,WAAW,CAAC;AAC5D,iBAAO;AACP,aAAK;AACL,YAAI,KAAK,EAAE;AACX,gBAAM,QAAQ,YAAC,KAAkB;AAAI,oBAC7B,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AACpC,iBAAO;AACP,gBAAM,UAAU,YAAC,KAAkB;AAAI,oBAC/B,IAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AAC/C,oBACQ,IAAI,SAAS,EAAE;AACvB,wBAAU,OAAO,IAAI,CAAC;AACtB,qBAAS;AACT,oBACQ,OAAO;AACf,wBAAU,KAAK,EAAE,8BAA8B;AAC/C,qBAAS,CAAC;AACV,iBAAO;AACP,aAAK;AACL,SAAG,CAAC,CAAC;AACL,IAAA,EAAE;AACF;AAC8B;AAC9B,IC7BA,IAAM,iBAAiB,GAAG,yBAAyB,CAAC;AACpD,IAAA,IAAM,+BAA+B,GAAG,4BAA4B,CAAC;AACrE,IAAA,IAAM,uBAAuB,GAAG,yBAAyB,CAAC;AAC1D,IACA,IAAM,YAAY,GAAG,UAAC,SAAiB;AAAI,QACzC,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAChD,QAAE,MAAM,CAAC,SAAS,GAAM,uBAAuB,UAAK,SAAW,CAAC;AAChE,QAAE,OAAO,MAAM,CAAC;AAChB,IAAA,CAAC,CAAC;AACF;AAEK,IADL;AAEO,QAGL,wBAAY,IAAqB,EAAE,IAAgB,EAAE,MAAoB;AAC3E;AAAwB,YAApB,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AACjD,YAAI,KAAK,CAAC,SAAS,GAAG,iBAAiB,CAAC;AACxC,YAAI,KAAK,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;AACzC,YACI,IAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAClD,YAAI,MAAM,CAAC,SAAS,GAAG,uBAAuB,CAAC;AAC/C,YACI,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;AAC9C,YAAI,GAAG,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;AAC5C,YAAI,GAAG,CAAC,YAAY,CAAC,KAAK,QAAE,IAAI,CAAC,KAAK,CAAC,GAAG,mCAAI,EAAE,CAAC,CAAC;AAClD,YAAI,GAAG,CAAC,YAAY,CAAC,OAAO,QAAE,IAAI,CAAC,KAAK,CAAC,KAAK,mCAAI,EAAE,CAAC,CAAC;AACtD,YAAI,GAAG,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;AAC7B,YACI,IAAM,iBAAiB,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;AACjD,YAAI,IAAM,cAAc,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;AAC9C,YAAI,IAAM,aAAa,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;AAC7C,YAAI,IAAM,gBAAgB,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;AAChD,YACI,IAAM,oBAAoB,GAAG,UAAC,GAAe;AAAI,gBAC/C,GAAG,CAAC,cAAc,EAAE,CAAC;AAC3B,gBACc,IAAA,KAAK,GAAe,IAAI,MAAnB,EAAE,QAAQ,GAAK,IAAI,SAAT,CAAU;AACvC,gBAAc,IAAA,EAAE,GAAK,KAAK,GAAV,CAAW;AAC3B,gBACM,IAAM,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC;AAC/B,gBAAM,IAAM,UAAU,GAAG,GAAG,CAAC,WAAW,CAAC;AACzC,gBACc,IAAA,KAAK,GAAK,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,MAAtC,CAAuC;AAC1D,gBAAM,IAAM,WAAW,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;AAC9C,gBACM,IAAM,WAAW,GAAG,UAAC,CAAa;AAAI,oBACpC,IAAM,QAAQ,GAAG,CAAC,CAAC,KAAK,CAAC;AACjC,oBAAQ,IAAM,QAAQ,GAAG,QAAQ,GAAG,MAAM,CAAC;AAC3C,oBAAQ,IAAM,aAAa,GAAG,UAAU,GAAG,QAAQ,CAAC;AACpD;AAEW;AACY,oBAAf,IAAI,aAAa,GAAG,WAAW,IAAI,aAAa,GAAG,EAAE,EAAE;AAC/D,wBAAU,OAAO;AACjB,qBAAS;AACT,oBACQ,KAAK,CAAC,KAAK,CAAC,KAAK,GAAM,aAAa,OAAI,CAAC;AACjD,iBAAO,CAAC;AACR,gBACM,IAAM,SAAS,GAAG,UAAC,CAAa;AAAI,oBAClC,CAAC,CAAC,cAAc,EAAE,CAAC;AAC3B,oBACQ,QAAQ,CAAC,mBAAmB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;AAC/D,oBAAQ,QAAQ,CAAC,mBAAmB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;AAC3D,oBACQ,IAAM,WAAW,GAAG,EAAE,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,IAAI,EAAE;AAC7D,wBAAU,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG;AAC7B,wBAAU,KAAK,EAAE,KAAK,CAAC,KAAK,CAAC,KAAK;AAClC,qBAAS,CAAC,CAAC;AACX,oBACQ,IAAM,WAAW,GAAG,WAAW,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC;AAC9D,oBAAQ,IAAM,YAAY,GAAG,IAAIG,8BAAa,CAAC,WAAW,CAAC,CAAC;AAC5D,oBACQ,WAAW,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;AAC/C,oBAAQ,QAAQ,CAAC,WAAW,CAAC,CAAC;AAC9B,iBAAO,CAAC;AACR,gBACM,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;AAC1D,gBAAM,QAAQ,CAAC,gBAAgB,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;AACtD,aAAK,CAAC;AACN,YACI,iBAAiB,CAAC,gBAAgB,CAAC,WAAW,EAAE,oBAAoB,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AAC1F,YAAI,cAAc,CAAC,gBAAgB,CAAC,WAAW,EAAE,oBAAoB,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AACvF,YAAI,aAAa,CAAC,gBAAgB,CAAC,WAAW,EAAE,oBAAoB,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AACtF,YAAI,gBAAgB,CAAC,gBAAgB,CAAC,WAAW,EAAE,oBAAoB,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AACzF,YACI,MAAM,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;AAC1C,YAAI,MAAM,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC;AACvC,YAAI,MAAM,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;AACtC,YAAI,MAAM,CAAC,WAAW,CAAC,gBAAgB,CAAC,CAAC;AACzC,YACI,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;AAC9B,YAAI,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;AAC3B,YACI,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC;AACrB,YAAI,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;AACnB,YAAI,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AACzB,SAAG;AACH,QACE,mCAAU,GAAV;AAAc,YACZ,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,+BAA+B,CAAC,CAAC;AAC5D,YAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;AACxC,SAAG;AAEH,QAAE,qCAAY,GAAZ;AAAc,YACZ,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,MAAM,CAAC,+BAA+B,CAAC,CAAC;AAC/D,YAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AACvC,SAAG;AACF,6BAAA;AAED,KAFC,IAAA;AACD,IACA,IAAM,cAAc,GAAG;AACvB,QAAE,MAAM,EAAE,IAAI;AACd,KAAC,CAAC;AACF,QACM,WAAW,GAAG,UAAC,IAAqB;AAAI,QAAzB,qBAAA,EAAA,qBAAqB;AAAI,QAC5C,IAAM,OAAO,mCAAQ,cAAc,GAAK,IAAI,CAAE,CAAC;AACjD,QACE,OAAO,IAAIJ,uBAAM,CAAC;AACpB,YAAI,GAAG,EAAE,IAAIC,0BAAS,CAAC,MAAM,CAAC;AAC9B,YAAI,KAAK,EAAE;AACX,gBAAM,SAAS,EAAE;AACjB,oBAAQ,KAAK,EAAE,UAAC,IAAqB,EAAE,IAAgB,EAAE,MAAoB;AAAI,wBACvE,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;AAC/B,4BAAY,OAAO,IAAI,CAAC;AACxB,yBAAW;AACX,wBAAU,OAAO,IAAI,cAAc,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;AACxD,qBAAS;AACT,iBAAO;AACP,aAAK;AACL,SAAG,CAAC,CAAC;AACL,IAAA,EAAE;AACF;AACyB;AAAC,ICzI1B;AACA;AAEA;AACO;AAAC;AACS;AAAiC;AAA6C;AAAC;AAAmE;AAAC;AAAM","sourcesContent":["import { Plugin, EditorState, PluginKey, Transaction } from 'prosemirror-state';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\n\nconst DEFAULT_PLACEHOLDER = 'Type Here...';\nconst PLACEHOLDER_CLASSNAME = 'NgxEditor__Placeholder';\n\nconst placeholderPlugin = (text: string = DEFAULT_PLACEHOLDER): Plugin => {\n  return new Plugin({\n    key: new PluginKey('placeholder'),\n    state: {\n      init(): string {\n        return text;\n      },\n      apply(tr: Transaction, previousVal: string): string {\n        const placeholder = tr.getMeta('UPDATE_PLACEHOLDER') ?? previousVal;\n        return placeholder;\n      }\n    },\n    props: {\n      decorations(state: EditorState): DecorationSet {\n        const doc = state.doc;\n\n        const placeholder = this.getState(state);\n\n        if (!placeholder) {\n          return DecorationSet.empty;\n        }\n\n        if (doc.childCount === 1 && doc?.firstChild?.isTextblock && doc.firstChild.content.size === 0) {\n          const placeHolderEl = document.createElement('span');\n          placeHolderEl.classList.add(PLACEHOLDER_CLASSNAME);\n          placeHolderEl.textContent = placeholder;\n          return DecorationSet.create(doc, [Decoration.widget(1, placeHolderEl)]);\n        }\n\n        return DecorationSet.empty;\n      }\n    }\n  });\n};\n\nexport default placeholderPlugin;\n","import { EditorState, Plugin, PluginKey, Transaction } from 'prosemirror-state';\n\nconst editablePlugin = (editable = true) => {\n  return new Plugin({\n    key: new PluginKey('editable'),\n    state: {\n      init(): boolean {\n        return editable;\n      },\n      apply(tr: Transaction, previousVal: boolean): string {\n        return tr.getMeta('UPDATE_EDITABLE') ?? previousVal;\n      }\n    },\n    props: {\n      editable(state: EditorState): boolean {\n        return this.getState(state);\n      },\n      attributes(state: EditorState): Record<string, string> | null {\n        const isEnabled = this.getState(state);\n\n        if (isEnabled) {\n          return null;\n        }\n\n        return {\n          class: 'NgxEditor__Content--Disabled'\n        };\n      }\n    }\n  });\n};\n\nexport default editablePlugin;\n","import { Node as ProsemirrorNode } from 'prosemirror-model';\nimport { NodeSelection, Plugin, PluginKey } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\n\nconst WRAPPER_CLASSNAME = 'NgxEditor__ImageWrapper';\nconst WRAPPER_RESIZE_ACTIVE_CLASSNAME = 'NgxEditor__Resizer--Active';\nconst RESIZE_HANDLE_CLASSNAME = 'NgxEditor__ResizeHandle';\n\nconst createHandle = (direction: string): HTMLElement => {\n  const handle = document.createElement('span');\n  handle.className = `${RESIZE_HANDLE_CLASSNAME}--${direction}`;\n  return handle;\n};\n\nclass ImageRezieView {\n  img: HTMLElement;\n  dom: HTMLElement;\n  handle: HTMLElement;\n\n  constructor(node: ProsemirrorNode, view: EditorView, getPos: () => number) {\n    const outer = document.createElement('span');\n    outer.className = WRAPPER_CLASSNAME;\n    outer.style.width = node.attrs.width;\n\n    const handle = document.createElement('span');\n    handle.className = RESIZE_HANDLE_CLASSNAME;\n\n    const img = document.createElement('img');\n    img.setAttribute('src', node.attrs.src);\n    img.setAttribute('alt', node.attrs.alt ?? '');\n    img.setAttribute('title', node.attrs.title ?? '');\n    img.style.width = '100%';\n\n    const handleBottomRight = createHandle('BR');\n    const handleTopRight = createHandle('TL');\n    const handleTopLeft = createHandle('TR');\n    const handleBottomLeft = createHandle('BL');\n\n    const resizePropoptionally = (evt: MouseEvent) => {\n      evt.preventDefault();\n\n      const { state, dispatch } = view;\n      const { tr } = state;\n\n      const startX = evt.pageX;\n      const startWidth = img.clientWidth;\n\n      const { width } = window.getComputedStyle(view.dom);\n      const editorWidth = parseInt(width, 10);\n\n      const onMouseMove = (e: MouseEvent) => {\n        const currentX = e.pageX;\n        const diffInPx = currentX - startX;\n        const computedWidth = startWidth + diffInPx;\n\n        // prevent image overflow the editor\n        // prevent resizng below 20px\n        if (computedWidth > editorWidth || computedWidth < 20) {\n          return;\n        }\n\n        outer.style.width = `${computedWidth}px`;\n      };\n\n      const onMouseUp = (e: MouseEvent) => {\n        e.preventDefault();\n\n        document.removeEventListener('mousemove', onMouseMove);\n        document.removeEventListener('mouseup', onMouseUp);\n\n        const transaction = tr.setNodeMarkup(getPos(), null, {\n          src: node.attrs.src,\n          width: outer.style.width\n        });\n\n        const resolvedPos = transaction.doc.resolve(getPos());\n        const newSelection = new NodeSelection(resolvedPos);\n\n        transaction.setSelection(newSelection);\n        dispatch(transaction);\n      };\n\n      document.addEventListener('mousemove', onMouseMove);\n      document.addEventListener('mouseup', onMouseUp);\n    };\n\n    handleBottomRight.addEventListener('mousedown', resizePropoptionally, { once: true });\n    handleTopRight.addEventListener('mousedown', resizePropoptionally, { once: true });\n    handleTopLeft.addEventListener('mousedown', resizePropoptionally, { once: true });\n    handleBottomLeft.addEventListener('mousedown', resizePropoptionally, { once: true });\n\n    handle.appendChild(handleBottomRight);\n    handle.appendChild(handleTopRight);\n    handle.appendChild(handleTopLeft);\n    handle.appendChild(handleBottomLeft);\n\n    outer.appendChild(handle);\n    outer.appendChild(img);\n\n    this.dom = outer;\n    this.img = img;\n    this.handle = handle;\n  }\n\n  selectNode(): void {\n    this.dom.classList.add(WRAPPER_RESIZE_ACTIVE_CLASSNAME);\n    this.handle.style.display = 'block';\n  }\n\n  deselectNode(): void {\n    this.dom.classList.remove(WRAPPER_RESIZE_ACTIVE_CLASSNAME);\n    this.handle.style.display = 'none';\n  }\n}\n\nconst defaultOptions = {\n  resize: true,\n};\n\nconst imagePlugin = (opts = defaultOptions): Plugin => {\n  const options = { ...defaultOptions, ...opts };\n\n  return new Plugin({\n    key: new PluginKey('link'),\n    props: {\n      nodeViews: {\n        image: (node: ProsemirrorNode, view: EditorView, getPos: () => number) => {\n          if (!options.resize) {\n            return null;\n          }\n          return new ImageRezieView(node, view, getPos);\n        },\n      }\n    }\n  });\n};\n\nexport default imagePlugin;\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"]}